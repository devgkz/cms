$(document).ready(function(){$(".ajaction").click(function(e){e.preventDefault(),cms.ajaction(this)}),$(document).keydown(function(e){27==e.keyCode?cms.modal.close():!e.ctrlKey||13!=e.keyCode&&10!=e.keyCode||$(".form-default").submit()}),$(window).scroll(function(){600<$(this).scrollTop()?$("#toTop").fadeIn():$("#toTop").fadeOut()}),$("#toTop").click(function(){return $("html, body").animate({scrollTop:0},200),!1})}),$(function(){var t=document.getElementById("file");defaultLabel=$(t).parent(".btn-upload").find("span").text(),t.addEventListener("change",function(e){if("png"!=t.value.substring(t.value.lastIndexOf(".")+1,t.value.length).toLowerCase()&&(alert("Only png files are accepted!"),t.value=null,$(t).parent(".btn-upload").find("span").html(defaultLabel)),fileNames=[],e.target.files.length)for(i=0;i<e.target.files.length;i++)fileNames.push(e.target.files[i].name);t.files.length?($(t).parent(".btn-upload").addClass("selected"),$(t).parent(".btn-upload").find("span").html("("+fileNames.length+" шт.) "+fileNames.join("; ").trim())):($(t).parent(".btn-upload").removeClass("selected"),$(t).parent(".btn-upload").find("span").html(defaultLabel))},!1)}),$(function(){$(".nav-trigger").click(function(e){$("#responsive-nav").toggleClass("show-md"),$("#responsive-nav").hasClass("show-md")?$(".nav-trigger").removeClass("nav-is-visible"):$(".nav-trigger").addClass("nav-is-visible")}),$('[data-toggle="tooltip"]').tooltip({delay:{show:0,hide:200}})});var cms={};!function(o,i){"use strict";var t,n=[],s=!1,a=function(){var e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",document.body.appendChild(e);var t=e.offsetWidth;e.style.overflow="scroll";var n=document.createElement("div");n.style.width="100%",e.appendChild(n);var o=n.offsetWidth;return e.parentNode.removeChild(e),t-o};function l(e,t,n){this.buildDOM(),this.content.html(e),this.addEventListeners(t,n)}l.prototype.buildDOM=function(){this.body=i(document.body),this.overlay=s?i("<div>").addClass("mw__overlay -transparent"):i("<div>").addClass("mw__overlay"),this.content=i('<div class="mw__content"></div>'),this.overlay.append(this.content),this.body.append(this.overlay)},l.prototype.addEventListeners=function(t,n){var o=this;i(this.content).on("click",".mw__confirm",function(e){e.preventDefault(),"function"==typeof t&&t(),o.close()}),i(this.content).on("click",".mw__cancel",function(e){e.preventDefault(),"function"==typeof n&&n(),o.close()}),this.overlay.on("click",function(e){i(e.target).hasClass("mw__overlay")&&("function"==typeof n&&n(),o.close())})},l.prototype.open=function(){return t=this,n.push(t),this.overlay.show(0),i("html").hasClass("mw-locked")||(i(document.body).css("padding-right","+="+a()),i("html").addClass("mw-locked"),s=!0),this.content.addClass("-opened"),this.content.find(".mw__confirm").focus(),this},l.prototype.close=function(){var e=this;n.pop(),t=n[n.length-1],setTimeout(function(){e.overlay.hide(),e.overlay.remove(),0==n.length&&(i(document.body).css("padding-right","-="+a()),i("html").removeClass("mw-locked"),s=!1)},80),this.content.removeClass("-opened")},o.modal={},o.modal.open=function(e){if(!t)return new l(e).open();t.content.html(e)},o.modal.wait=function(e){e=e||300,o.microbar||(o.microbar=new MProgress),o.microbar.interval(e).show()},o.modal.waitClose=function(){o.microbar.hide()},o.modal.alert=function(e,t){var n=new l("",t,t);n.content.append('<div style="margin-bottom:1rem">'+e+"</div>"),n.content.append('<div class="text-center"><button type="button" class="btn primary mw__confirm">ОК</button></div>'),n.content.find(".mw__confirm").focus(),n.open()},o.modal.confirm=function(e,t,n){var o=new l("",t,n);o.content.append('<div style="margin-bottom:1rem">'+e+"</div>"),o.content.append('<div class="text-center"><button type="button" class="btn primary mw__confirm">ОК</button> <button type="button" class="btn mw__cancel">Отмена</button></div>'),o.content.find(".mw__confirm").focus(),o.open()},o.modal.openAjax=function(e){o.modal.wait(),i.get(e).done(function(e){o.modal.waitClose(),o.modal.open(e)}).fail(function(){o.modal.waitClose(),o.modal.alert("Ошибка связи. Проверьте интернет<br> и попробуйте еще раз",o.modal.closeAll)})},o.modal.close=function(){return t&&t.close(),!1},o.modal.closeAll=function(){if(0<n.length)for(var e;e=n[n.length-1];)console.log(e),e&&e.close()},o.ajaction=function(t,e){if(e||(e="Are you sure?"),!i(t).hasClass("-confirmable")){var n=i(t).attr("href");return o.modal.openAjax(n),!1}o.modal.confirm(e,function(){var e=i(t).attr("href");return o.modal.openAjax(e),!1},function(){return!1})},o.ajaxSubmit=function(e,t){"function"==typeof t.before&&t.before();var n=t.url||e.action,o=new FormData(e),i=new XMLHttpRequest;return i.open("POST",n,!0),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.send(o),i.onload=function(e){4==i.readyState&&(200==this.status?"function"==typeof t.success&&t.success(i.responseText):"function"==typeof t.error&&t.error(this.status))},!(i.onerror=function(e){"function"==typeof t.error&&t.error()})},o.ajaxSubmitModal=function(e){return o.ajaxSubmit(e,{before:function(){o.modal.wait(0)},success:function(e){o.modal.waitClose(),o.modal.open(e)},error:function(e){o.modal.waitClose(),o.modal.alert("Ошибка связи. Проверьте интернет<br> и попробуйте еще раз",o.modal.closeAll)}}),!1}}(cms,window.jQuery||window.Zepto),cms.notice={},cms.notice.init=function(){null==document.querySelector(".nw")&&$(document.body).append('<div class="nw nw-hidden"></div>')},cms.notice.show=function(e,t,n){cms.notice.init();var o=document.createElement("div");return o.className="nw__message"+("string"==typeof t&&""!==t?" "+t:""),o.innerHTML=e,$(".nw").prepend(o),$(".nw").hasClass("nw-hidden")&&$(".nw").removeClass("nw-hidden"),setTimeout(function(){o.className=o.className+" -show"},10),cms.notice.close(o,n),o},cms.notice.close=function(e,t){var n=isNaN(t)?4e3:t;$(e).on("click",function(){cms.notice.hide(e)}),0!==n&&setTimeout(function(){cms.notice.hide(e)},n)},cms.notice.hide=function(e){var t=document.querySelector(".nw");void 0!==e&&e.parentNode===t&&(e.className+=" nw-hidden",setTimeout(function(){t.removeChild(e)},150),t.hasChildNodes()||(t.className+=" nw-hidden"))},cms.notice.hideAll=function(){var e=document.querySelector(".nw");e&&(e.innerHTML="",e.hasChildNodes()||(e.className+=" nw-hidden"))},function(e){function t(e){this.el=document.createElement("div"),function(e){for(var t=Array.prototype.slice.call(arguments,1),n=0;n<t.length;n++)for(var o in t[n])e[o]=t[n][o]}(this.el.style,{position:"fixed",width:"0%",height:"4px",top:"0",left:"0",right:"0",zIndex:1e4,background:"#FFDD57",transition:"width 0.05s ease"},e)}t.prototype.interval=function(e){return e=e||500,this.intervalID=setInterval(this.increase.bind(this),e),this.el.style.transition="width "+e/1e3+"s linear",this},t.prototype.show=function(){return this.set(0),document.getElementsByTagName("body")[0].appendChild(this.el),this},t.prototype.hide=function(){return this.set(100),setTimeout(this.remove.bind(this),200),this},t.prototype.remove=function(){return this.intervalID&&clearInterval(this.intervalID),this.el.parentNode.removeChild(this.el),this},t.prototype.set=function(e){return this.el.style.width=e+"%",this},t.prototype.get=function(){return parseFloat(this.el.style.width.split("%")[0])},t.prototype.increase=function(e){return e||(e=3),this.set(this.get()+e),this},"function"==typeof define&&define.amd?define(function(){return t}):"undefined"!=typeof module&&module.exports?module.exports=t:e.MProgress=t}(this);